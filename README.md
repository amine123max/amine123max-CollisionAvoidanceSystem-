# amine123max-CollisionAvoidanceSystem-
构建一个简化的仿真模型来复现文献中的碰撞避让策略。这个模型包括：  AUV与ROV的动态建模。  使用动态贝叶斯网络评估碰撞概率。  并加入键盘作为输入进行控制，模拟显示中手动控制ROV与AUV进行联合工作
# AUV与ROV碰撞避让策略

基于动态贝叶斯网络(DBN)和随机模型预测控制(SMPC)的AUV与ROV碰撞避让策略，并将人类控制意图纳入决策过程。

## 功能特点

- 动态贝叶斯网络(DBN)用于估计ROV的运动状态和意图
- 随机模型预测控制(SMPC)用于生成最优避障轨迹
- 考虑人类操作员意图，分为三类：忽视、激进和礼貌
- 实时轨迹规划和碰撞风险评估
- **键盘交互控制**：使用键盘方向键控制ROV运动
- **2D模拟场景地图**：支持随机生成固定障碍物的环境
- **交互式模拟**：先生成地图和静态障碍物，然后通过键盘控制ROV，AUV自主避障

## 安装依赖

```bash
pip install -r requirements.txt
```

主要依赖：
- numpy：数值计算
- matplotlib：数据可视化
- pygame：键盘控制接口和图形界面

## 使用方法

### 基本运行

```bash
python main.py
```

### 键盘控制模式

使用键盘方向键控制ROV运动：

```bash
python main.py --keyboard_control
```

- **↑**：向上加速（y轴负方向）
- **↓**：向下加速（y轴正方向）
- **←**：向左加速（x轴负方向）
- **→**：向右加速（x轴正方向）
- **空格**：停止（加速度归零）

### 2D模拟场景地图

启用带有随机障碍物的2D模拟场景地图：

```bash
python main.py --use_map --num_obstacles 15
```

可以结合键盘控制：

```bash
python main.py --use_map --keyboard_control
```

地图相关参数：
- `--use_map`：启用2D模拟场景地图
- `--num_obstacles`：障碍物数量（默认10个）
- `--map_width`：地图宽度（默认200）
- `--map_height`：地图高度（默认200）

### 交互式模拟

运行专门的交互式模拟（先生成地图和静态障碍物，然后通过键盘控制ROV，AUV自主避障）：

```bash
python interactive_simulation.py
```

交互式模拟控制：
- **↑/↓/←/→**：控制ROV加速度
- **空格**：暂停/继续模拟
- **R**：重置ROV位置
- **A**：重置AUV位置
- **H**：显示/隐藏帮助信息
- **ESC**：退出模拟

交互式模拟参数：
- `--num_obstacles`：障碍物数量（默认15个）
- `--map_width`：地图宽度（默认200）
- `--map_height`：地图高度（默认200）
- `--dt`：时间步长（默认0.1秒）
- `--seed`：随机数种子，用于复现结果
- `--save_dir`：结果保存目录（默认'results'）

### 其他参数

```bash
python main.py --help
```

主要参数：
- `--save_dir`：结果保存目录
- `--no_plot`：不显示图形结果
- `--sim_time`：模拟总时间(秒)
- `--dt`：时间步长(秒)
- `--intent_change_time`：人类意图改变的时间点(秒)
- `--seed`：随机数种子，用于复现结果
- `--ignore_prob`：人类忽视意图概率
- `--aggressive_prob`：人类激进意图概率
- `--polite_prob`：人类礼貌意图概率
- `--keyboard_control`：启用键盘控制ROV运动

## 输出结果

运行后，程序会在指定目录（默认为`results/`）生成以下文件：

1. **轨迹图**：AUV与ROV的运动轨迹
2. **控制输入图**：AUV和ROV的控制输入随时间变化
3. **意图概率图**：ROV意图概率随时间变化
4. **数据文件**：`.npy`格式的原始数据

## 系统架构

系统主要由以下组件构成：

1. **动态贝叶斯网络(DBN)**：估计ROV运动状态和意图
2. **随机模型预测控制(SMPC)**：实现随机模型预测控制
3. **碰撞避让系统**：整合DBN和SMPC
4. **键盘控制模块**：实现交互式ROV控制
5. **模拟场景地图**：生成2D环境和随机障碍物
6. **交互式模拟**：实现实时交互控制和可视化

## 障碍物类型

模拟场景中包含两种类型的障碍物：

1. **圆形障碍物**：由中心点和半径定义
2. **矩形障碍物**：由左上角坐标、宽度、高度和旋转角度定义

障碍物会影响AUV和ROV的运动，发生碰撞时会产生反弹效果。

## 注意事项

- 键盘控制和地图功能需要安装pygame库
- 如果遇到中文显示问题，请确保系统安装了SimHei字体 
